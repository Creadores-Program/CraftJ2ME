<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Render</title>
    <style>
        body, html{
            background-color: black;
        }
        #container{
            position: fixed;
            width: 100%;
            height: 100%;
            left: 0%;
            top: 0%;
            bottom: 0%;
            right: 0%;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <script type="module">
        import * as THREE from 'https://esm.run/three';
        import { GLTFLoader } from "https://cdn.jsdelivr.net/npm/three/examples/jsm/loaders/GLTFLoader.js/+esm";
        window.THREE = THREE;
        window.GLTFLoader = GLTFLoader;
        const textureLoader = new THREE.TextureLoader();
        function loadTexture(path) {
            const texture = textureLoader.load(path);
            texture.colorSpace = THREE.SRGBColorSpace;
            texture.magFilter = THREE.NearestFilter;
            texture.minFilter = THREE.NearestFilter;
            return texture;
        }
        //carga de bloques
        const blockStandarGeometry = THREE.BoxGeometry(1, 1, 1);
        let blocksTextur = {
            "11892": null,//air
            "1791": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone.png")),//stone
            "86": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone_granite.png")),//granite
            "1164": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone_granite_smooth.png")),//polished granite
            "152": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone_diorite.png")),//diorite
            "10045": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone_diorite_smooth.png")),//polished_diorite
            "1789": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone_andesite.png")),//andesite
            "13249": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("stone_andesite_smooth.png")),//polished_andesite
            "10617": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("grass_carried.png")),//grass_block
            "9578": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("dirt.png")),//dirt
            "7966": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("dirt_podzol_top.png")),//podzol
            "5997": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("cobblestone.png")),//cobblestone
            "13245": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("planks_oak.png")),//oak_planks
            "13607": loadTexture("data:image/png;base64,"+JavaComunique.getTexture("planks_spruce.png")),//spruce_planks
        };
        let blocksMaterial = {
            "11892": null,//air
            "1791": [//stone
                new THREE.MeshBasicMaterial({ map: blocksTextur["1791"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1791"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1791"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1791"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1791"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1791"] })
            ],
            "86": [//granite
                new THREE.MeshBasicMaterial({ map: blocksTextur["86"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["86"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["86"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["86"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["86"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["86"] })
            ],
            "1164": [//polished granite
                new THREE.MeshBasicMaterial({ map: blocksTextur["1164"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1164"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1164"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1164"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1164"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1164"] })
            ],
            "152": [//diorite
                new THREE.MeshBasicMaterial({ map: blocksTextur["152"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["152"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["152"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["152"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["152"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["152"] })
            ],
            "10045": [//polished_diorite
                new THREE.MeshBasicMaterial({ map: blocksTextur["10045"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10045"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10045"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10045"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10045"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10045"] })
            ],
            "1789": [//andesite
                new THREE.MeshBasicMaterial({ map: blocksTextur["1789"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1789"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1789"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1789"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1789"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["1789"] })
            ],
            "13249": [//polished_andesite
                new THREE.MeshBasicMaterial({ map: blocksTextur["13249"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13249"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13249"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13249"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13249"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13249"] })
            ],
            "10617": [//grass_block
                new THREE.MeshBasicMaterial({ map: blocksTextur["10617"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10617"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10617"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10617"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10617"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["10617"] })
            ],
            "9578": [//dirt
                new THREE.MeshBasicMaterial({ map: blocksTextur["9578"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["9578"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["9578"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["9578"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["9578"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["9578"] })
            ],
            "7966": [//podzol
                new THREE.MeshBasicMaterial({ map: blocksTextur["7966"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["7966"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["7966"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["7966"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["7966"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["7966"] })
            ],
            "5997": [//cobblestone
                new THREE.MeshBasicMaterial({ map: blocksTextur["5997"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["5997"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["5997"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["5997"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["5997"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["5997"] })
            ],
            "13245": [//oak_planks
                new THREE.MeshBasicMaterial({ map: blocksTextur["13245"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13245"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13245"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13245"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13245"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13245"] })
            ],
            "13607": [//spruce_planks
                new THREE.MeshBasicMaterial({ map: blocksTextur["13607"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13607"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13607"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13607"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13607"] }),
                new THREE.MeshBasicMaterial({ map: blocksTextur["13607"] })
            ]
        };
        let blocks = {
            "11892": null,//air
            "1791": new THREE.Mesh(blockStandarGeometry, blocksMaterial["1791"]),//stone
            "86": new THREE.Mesh(blockStandarGeometry, blocksMaterial["86"]),//granite
            "1164": new THREE.Mesh(blockStandarGeometry, blocksMaterial["1164"]),//polished granite
            "152": new THREE.Mesh(blockStandarGeometry, blocksMaterial["152"]),//diorite
            "10045": new THREE.Mesh(blockStandarGeometry, blocksMaterial["10045"]),//polished_diorite
            "1789": new THREE.Mesh(blockStandarGeometry, blocksMaterial["1789"]),//andesite
            "13249": new THREE.Mesh(blockStandarGeometry, blocksMaterial["13249"]),//polished_andesite
            "10617": new THREE.Mesh(blockStandarGeometry, blocksMaterial["10617"]),//grass_block
            "9578": new THREE.Mesh(blockStandarGeometry, blocksMaterial["9578"]),//dirt
            "9579": blocks["9578"],//dirt2
            "7966": new THREE.Mesh(blockStandarGeometry, blocksMaterial["7966"]),//podzol
            "5997": new THREE.Mesh(blockStandarGeometry, blocksMaterial["5997"]),//cobblestone
            "13245": new THREE.Mesh(blockStandarGeometry, blocksMaterial["13245"]),//oak_planks
            "13607": new THREE.Mesh(blockStandarGeometry, blocksMaterial["13607"]),//spruce_planks
        };
        window.rendererMC = new THREE.WebGLRenderer();
        window.rendererMC.setPixelRatio(window.devicePixelRatio);
        window.rendererMC.setSize(window.innerWidth, window.innerHeight);
        window.rendererMC.setClearColor(0x80a0e0);
        window.rendererMC.shadowMap.enabled = true;
        window.rendererMC.shadowMap.type = THREE.PCFSoftShadowMap;
        document.getElementById("container").appendChild(window.rendererMC.domElement);
        window.sceneTR = new THREE.Scene();
        window.sceneTR.fog = new THREE.Fog(0x80a0e0, 50, 75);
        window.setBlock = function setBlock(x, y, z, id){
            let blockOriginal = blocks[id];
            let BlockCloned;
            if(blockOriginal === undefined){
                //usar bloque update
                return;
            }
            if(blockOriginal == null){
                return;
            }
            let PosTH = new THREE.Vector3(x, y, z);
            for(let obj of window.sceneTR.children){
                if(obj.isMesh){
                    if(obj.position.equals(PosTH) && obj.geometry == blockStandarGeometry){
                        window.sceneTR.remove(obj);
                    }
                }
            }
            BlockCloned = blockOriginal.clone();
            BlockCloned.position.x = x;
            BlockCloned.position.y = y;
            BlockCloned.position.z = z;
            window.sceneTR.add(BlockCloned);
        };
        JavaComunique.doneThree();
    </script>
</body>
</html>